{% extends "jinhtml/skel.html" %}
{% block headcss %}
	<style>
		thead tr > td {
			font-size:1.5em;
		}
		td {
			border-width:0px 1px 1px 0px;
			border-style:solid;
			font-size:1.2em;
		}
		table#listcal {
			border-width:1px 0px 0px 1px;
			border-style:solid;
			border-color:black;
			text-align:center;
		}
		tr.event > td {
			padding:20px;
		}
		td {
			height:20px;
		}
		td.date {
			min-width:25px;
			width:100px;
		}
		td.week {
			width:80px;
		}
		td.time {
			width:150px;
		}
		div#unmatchedmessage {
			text-align:center;
			font-size:2em;
			display:none;
		}
	</style>
{% endblock %}

{% block onload %}
	pushevent (); 
	pushtestdata ();
	var switchlistobj = document.getElementById("switchlist")
	switchlistobj.className += "selected";
	switchlistobj.onclick = "";
{% endblock %}

{% block headjs %}
	<script type = "text/javascript">
		function pushevent () {//將活動放入行事曆中
			var eventbody = document.getElementById ("eventbody");
			var dataclass = ["date", "week", "time", "content"];
			var Event, data;
			for (var i = 0 ; i < 10 ; i++) {
				Event = document.createElement ("tr");
				Event.id = "event" + (i + 1);//建立每一個活動的id
				Event.className = "event";
				for (var j = 0 ; j < 4 ; j++) {
					data = document.createElement ("td");
					data.id = Event.id + dataclass[j];//建立每一個欄位的id	format = event<i><className>
					data.className = dataclass[j];
					Event.appendChild (data);
				}
				eventbody.appendChild (Event);
			}
		}
		function searchevent () {//搜尋符合的活動
			var obj = document.getElementById ("searchingoption");//obj = <select>
			var option = obj[obj.selectedIndex].value;//option = date or content
			var events = document.getElementById ("eventbody").getElementsByClassName ("event");
			var matchedNum = 0;
			if (option == "content") {
				var string = document.getElementById ("searchingcontent").value;
				var eventscontent = document.getElementById ("eventbody").getElementsByClassName ("content");
				for (var i = 0 ; i < eventscontent.length ; i++) {
					if (eventscontent[i].innerHTML.search (string) != -1) {
						events[i].style.display = "table-row";
						matchedNum++;
					}
					else {//Not Match
						events[i].style.display = "none";
					}
				}
			}
			else if (option == "date") {
				var month = document.getElementById ("searchingdatemonth").value;
				var day = document.getElementById ("searchingdateday").value;
				var eventsdate = document.getElementById ("eventbody").getElementsByClassName ("date");
				var dateinfo = new Array ();
				for (var i = 0 ; i < eventsdate.length ; i++) {
					dateinfo = eventsdate[i].innerHTML.split (".");
					if ((month == "" || dateinfo[1] == month) && (day == "" || dateinfo[2] == day)) {
						events[i].style.display = "table-row";
						matchedNum++;
					}
					else {//Not Match
						events[i].style.display = "none";
					}
				}
			}
			if (matchedNum == 0) {
				document.getElementById ("unmatchedmessage").style.display = "block";
			}
			else {
				document.getElementById ("unmatchedmessage").style.display = "none";
			}
		}
		function changesearchingbar (obj) {
			var searchingdate = document.getElementById ("searchingdate");
			var searchingcontent = document.getElementById ("searchingcontent");
			if (obj.value == "date") {
				searchingdate.style.display = "inline";
				searchingcontent.style.display = "none";
			}
			else if (obj.value == "content") {
				searchingdate.style.display = "none";
				searchingcontent.style.display = "inline";
			}
		}
	</script>
	<!--<script src = "testdataforlist.js" type = "text/javascript"></script><!-- testdata -->
	<script>
		function pushtestdata () {//push test data
		document.getElementById ("event1date").innerHTML = "2012.11.28";
		document.getElementById ("event1week").innerHTML = "星期三";
		document.getElementById ("event1time").innerHTML = "20:30 - 22:00";
		document.getElementById ("event1content").innerHTML = "期末Project Online";
		document.getElementById ("event2date").innerHTML = "2012.12.21";
		document.getElementById ("event2week").innerHTML = "星期五";
		document.getElementById ("event2time").innerHTML = "?:?? - ?:??";
		document.getElementById ("event2content").innerHTML = "世界末日";
		document.getElementById ("event3date").innerHTML = "2013.6.20";
		document.getElementById ("event3week").innerHTML = "星期四";
		document.getElementById ("event3time").innerHTML = "0:00 - 24:00";
		document.getElementById ("event3content").innerHTML = "生日大會";
		}
	</script>
{% endblock %}

{% block body %}
	<div id = "searchbar" align = "center">
		<select id = "searchingoption" onchange = "changesearchingbar (this);">
			<option value = "date"> 日期 </option>
			<option value = "content" selected = "selected"> 內容 </option>
		</select>
		<input id = "searchingcontent" type = "text" onkeyup = "searchevent ();">
		<div id = "searchingdate" style = "display:none;">
			<input id = "searchingdatemonth" type = "text" size = "2" onkeyup = "searchevent ();"> 月
			<input id = "searchingdateday" type = "text" size = "2" onkeyup = "searchevent ();"> 日
		</div>
	</div>
	<div align = "center">
		<table id = "listcal" cellpadding = "0" cellspacing = "0" style = "width:1880px;">
			<thead>
				<tr>
					<td colspan = "3" id = "date"> 日期 </td>
					<td id = "eventcontent" style = "width:1418px;"> 內容 </td>
				</tr>
			</thead>
			<tbody id = "eventbody">
			</tbody>
		</table>
	</div>
	<div id = "unmatchedmessage">
		找不到匹配項
	</div>
{% endblock %}